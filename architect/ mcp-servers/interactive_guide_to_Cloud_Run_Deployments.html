<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Google Cloud Build Template Tutorial</title>
    <style>
        /* Base Styles - Using the extracted design system */
        :root {
            --primary-blue: #3498db;
            --dark-blue-1: #2c3e50;
            --dark-blue-2: #34495e;
            --light-grey: #f8f9fa;
            --off-white: #f1f2f6;
            --pure-white: #ffffff;
            --border-color: #e9ecef;
            --border-color-2: #ddd;
            --text-dark: #333;
            --text-medium: #7f8c8d;
            --warning-bg: #fff3cd;
            --warning-border: #f39c12;
            --info-bg: #d1ecf1;
            --info-border: #17a2b8;
            --success-bg: #d4edda;
            --success-border: #28a745;
            --code-bg: #2d3748;
            --code-text: #e2e8f0;
            --python-color: #ff6b6b;
            --string-color: #4ecdc4;
            --comment-color: #95a5a6;
            --keyword-color: #e74c3c;
            --number-color: #f39c12;
            --block-color: #e74c3c;
            --allow-color: #27ae60;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background-color: var(--pure-white);
            display: grid;
            grid-template-columns: 280px 1fr;
        }

        /* Header Styles */
        header {
            grid-column: 1 / -1;
            text-align: center;
            padding: 2rem;
            border-bottom: 3px solid var(--primary-blue);
            background: linear-gradient(135deg, var(--pure-white) 0%, var(--light-grey) 100%);
        }

        h1 {
            font-size: 2.5rem;
            color: var(--dark-blue-1);
            margin-bottom: 1rem;
        }

        h2 {
            font-size: 2rem;
            color: var(--dark-blue-1);
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 0.5rem;
            margin: 2rem 0 1rem;
        }

        h3 {
            font-size: 1.5rem;
            color: var(--dark-blue-2);
            margin: 1.5rem 0 0.5rem;
        }

        h4 {
            font-size: 1.2rem;
            color: var(--dark-blue-2);
            margin: 1rem 0 0.5rem;
        }

        p {
            margin-bottom: 1rem;
        }

        /* Table of Contents */
        .toc {
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
            background-color: var(--light-grey);
            padding: 1.5rem;
            border-right: 1px solid var(--border-color);
        }

        .toc h2 {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            border-bottom: none;
        }

        .toc ul {
            list-style-type: none;
        }

        .toc li {
            margin-bottom: 0.5rem;
        }

        .toc a {
            color: var(--primary-blue);
            text-decoration: none;
            font-size: 0.9rem;
            display: block;
            padding: 0.3rem 0;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .toc a:hover {
            color: #2980b9;
            background-color: rgba(52, 152, 219, 0.1);
            padding-left: 0.5rem;
        }

        .toc .sub-item {
            margin-left: 1rem;
            font-size: 0.8rem;
        }

        /* Main Content */
        .content {
            padding: 2rem;
            max-width: 1200px;
        }

        section {
            margin-bottom: 3rem;
        }

        /* Interactive Code Display */
        .interactive-code {
            background-color: var(--code-bg);
            color: var(--code-text);
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1.5rem 0;
            font-family: 'Courier New', monospace;
            position: relative;
            overflow-x: auto;
        }

        .code-line {
            display: block;
            padding: 0.2rem 0;
            cursor: pointer;
            transition: background-color 0.2s;
            border-radius: 4px;
            margin: 0.1rem 0;
        }

        .code-line:hover {
            background-color: rgba(52, 152, 219, 0.2);
        }

        .code-line.highlighted {
            background-color: rgba(52, 152, 219, 0.3);
            border-left: 3px solid var(--primary-blue);
            padding-left: 0.5rem;
        }

        .code-comment { color: var(--comment-color); font-style: italic; }
        .code-keyword { color: var(--keyword-color); font-weight: bold; }
        .code-string { color: var(--string-color); }
        .code-number { color: var(--number-color); }

        /* Explanation Panel */
        .explanation-panel {
            background-color: var(--light-grey);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            display: none;
        }

        .explanation-panel.active {
            display: block;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Status Boxes */
        .status-box {
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid;
            border-radius: 4px;
        }

        .warning {
            background-color: var(--warning-bg);
            border-left-color: var(--warning-border);
        }

        .info {
            background-color: var(--info-bg);
            border-left-color: var(--info-border);
        }

        .success {
            background-color: var(--success-bg);
            border-left-color: var(--success-border);
        }

        /* Template Builder */
        .template-builder {
            background-color: var(--off-white);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 2rem;
            margin: 2rem 0;
        }

        .builder-section {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--border-color-2);
        }

        .builder-section:last-child {
            border-bottom: none;
        }

        .form-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .form-control {
            display: flex;
            flex-direction: column;
        }

        label {
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: var(--dark-blue-2);
        }

        input, select, textarea {
            padding: 0.7rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-family: inherit;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .button {
            background-color: var(--primary-blue);
            color: white;
            border: none;
            padding: 0.7rem 1.5rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.2s;
            margin: 0.5rem 0.5rem 0.5rem 0;
        }

        .button:hover {
            background-color: #2980b9;
        }

        .button-secondary {
            background-color: var(--text-medium);
        }

        .button-secondary:hover {
            background-color: #6c7b7d;
        }

        /* Output Display */
        .output-container {
            background-color: var(--code-bg);
            color: var(--code-text);
            padding: 1.5rem;
            border-radius: 8px;
            margin-top: 1rem;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
        }

        /* Progress Indicator */
        .progress-steps {
            display: flex;
            justify-content: space-between;
            margin: 2rem 0;
            position: relative;
        }

        .progress-steps::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background-color: var(--border-color);
            z-index: 1;
        }

        .progress-step {
            background-color: var(--light-grey);
            border: 2px solid var(--border-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            z-index: 2;
            transition: all 0.3s;
        }

        .progress-step.active {
            background-color: var(--primary-blue);
            color: white;
            border-color: var(--primary-blue);
        }

        .progress-step.completed {
            background-color: var(--allow-color);
            color: white;
            border-color: var(--allow-color);
        }

        /* Component Highlighter */
        .component-highlighter {
            position: relative;
            display: inline-block;
        }

        .highlight-box {
            position: absolute;
            background-color: rgba(52, 152, 219, 0.2);
            border: 2px solid var(--primary-blue);
            border-radius: 4px;
            pointer-events: none;
            z-index: 10;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        /* Quiz Components */
        .quiz-container {
            background-color: var(--off-white);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .quiz-question {
            font-weight: bold;
            margin-bottom: 1rem;
            color: var(--dark-blue-1);
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .quiz-option {
            padding: 0.5rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            background-color: var(--pure-white);
        }

        .quiz-option:hover {
            background-color: rgba(52, 152, 219, 0.1);
        }

        .quiz-option.correct {
            background-color: var(--success-bg);
            border-color: var(--success-border);
        }

        .quiz-option.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545;
        }

        .quiz-feedback {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 4px;
            display: none;
        }

        .quiz-feedback.show {
            display: block;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            body {
                grid-template-columns: 1fr;
            }

            .toc {
                position: static;
                height: auto;
                border-right: none;
                border-bottom: 1px solid var(--border-color);
            }

            .form-group {
                grid-template-columns: 1fr;
            }

            .progress-steps {
                flex-direction: column;
                align-items: center;
                gap: 1rem;
            }

            .progress-steps::before {
                display: none;
            }
        }

        /* Copy Button */
        .copy-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: rgba(52, 152, 219, 0.8);
            color: white;
            border: none;
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .interactive-code:hover .copy-button {
            opacity: 1;
        }

        .copy-button:hover {
            background-color: var(--primary-blue);
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 1rem;
        }

        .tab {
            padding: 0.7rem 1.2rem;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }

        .tab.active {
            border-bottom-color: var(--primary-blue);
            color: var(--primary-blue);
            font-weight: bold;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <header>
        <h1>ðŸš€ Google Cloud Build Template Mastery</h1>
        <p>Learn to build, deploy, and manage multi-service applications with Google Cloud Build</p>
    </header>

    <nav class="toc">
        <h2>Navigation</h2>
        <ul>
            <li><a href="#basics">Template Basics</a></li>
            <li><a href="#anatomy">Code Anatomy</a></li>
            <li><a href="#interactive-breakdown">Interactive Breakdown</a></li>
            <li><a href="#builder">Template Builder</a></li>
            <li><a href="#quiz">Knowledge Quiz</a></li>
            <li><a href="#examples">Real Examples</a></li>
            <li><a href="#troubleshooting">Troubleshooting</a></li>
        </ul>
    </nav>

    <main class="content">
        <section id="basics">
            <h2>Understanding Cloud Build Templates</h2>
            
            <div class="status-box info">
                <h4>What is a Cloud Build Template?</h4>
                <p>A Cloud Build template is a YAML configuration file that defines automated build and deployment steps for your applications. It tells Google Cloud Build exactly how to build your code, create Docker images, and deploy services.</p>
            </div>

            <h3>Core Concepts</h3>
            <div class="progress-steps">
                <div class="progress-step completed">1</div>
                <div class="progress-step completed">2</div>
                <div class="progress-step completed">3</div>
                <div class="progress-step active">4</div>
            </div>
            <p style="text-align: center; margin-top: 1rem;"><strong>Build â†’ Push â†’ Deploy â†’ Manage</strong></p>

            <div class="tabs">
                <div class="tab active" data-tab="concepts">Key Concepts</div>
                <div class="tab" data-tab="benefits">Benefits</div>
                <div class="tab" data-tab="when-to-use">When to Use</div>
            </div>

            <div id="concepts" class="tab-content active">
                <h4>Essential Components</h4>
                <p><strong>Steps:</strong> Individual build actions (build, push, deploy)</p>
                <p><strong>Substitutions:</strong> Variables that make your template reusable</p>
                <p><strong>Builders:</strong> Pre-configured tools (Docker, gcloud, etc.)</p>
                <p><strong>Dependencies:</strong> Control execution order with waitFor</p>
            </div>

            <div id="benefits" class="tab-content">
                <h4>Why Use This Approach?</h4>
                <p><strong>Consistency:</strong> Same codebase, multiple services</p>
                <p><strong>Efficiency:</strong> Build once, deploy multiple times</p>
                <p><strong>Scalability:</strong> Easy to add new services</p>
                <p><strong>Automation:</strong> No manual deployment steps</p>
            </div>

            <div id="when-to-use" class="tab-content">
                <h4>Perfect Use Cases</h4>
                <p><strong>Microservices:</strong> Multiple services from one codebase</p>
                <p><strong>Multi-environment:</strong> Different configurations per environment</p>
                <p><strong>Modular Apps:</strong> API + Worker + Scheduler patterns</p>
                <p><strong>Team Collaboration:</strong> Standardized deployment process</p>
            </div>
        </section>

        <section id="anatomy">
            <h2>Template Code Anatomy</h2>
            
            <p>Let's break down a complete Cloud Build template. Click on any line to see detailed explanations:</p>

            <div class="interactive-code">
                <button class="copy-button" onclick="copyCode()">Copy Code</button>
                <div class="code-line" data-explanation="header">
                    <span class="code-comment"># =============================================================================</span>
                </div>
                <div class="code-line" data-explanation="header">
                    <span class="code-comment"># GOOGLE CLOUD BUILD TEMPLATE - MULTI-SERVICE DEPLOYMENT</span>
                </div>
                <div class="code-line" data-explanation="header">
                    <span class="code-comment"># =============================================================================</span>
                </div>
                <div class="code-line" data-explanation="steps-intro">
                    <span class="code-keyword">steps</span>:
                </div>
                <div class="code-line" data-explanation="build-step">
                    &nbsp;&nbsp;<span class="code-comment"># Step 1: Build Docker image</span>
                </div>
                <div class="code-line" data-explanation="build-step">
                    &nbsp;&nbsp;- <span class="code-keyword">name</span>: <span class="code-string">'gcr.io/cloud-builders/docker'</span>
                </div>
                <div class="code-line" data-explanation="build-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">id</span>: <span class="code-string">'build-base-image'</span>
                </div>
                <div class="code-line" data-explanation="build-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">args</span>: 
                </div>
                <div class="code-line" data-explanation="build-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="code-string">'build'</span>
                </div>
                <div class="code-line" data-explanation="build-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="code-string">'-t'</span>
                </div>
                <div class="code-line" data-explanation="build-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="code-string">'${_REGION}-docker.pkg.dev/$PROJECT_ID/${_REPO_NAME}/${_IMAGE_NAME}:latest'</span>
                </div>
                <div class="code-line" data-explanation="build-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="code-string">'.'</span>
                </div>
                <div class="code-line">&nbsp;</div>
                <div class="code-line" data-explanation="push-step">
                    &nbsp;&nbsp;<span class="code-comment"># Step 2: Push to Artifact Registry</span>
                </div>
                <div class="code-line" data-explanation="push-step">
                    &nbsp;&nbsp;- <span class="code-keyword">name</span>: <span class="code-string">'gcr.io/cloud-builders/docker'</span>
                </div>
                <div class="code-line" data-explanation="push-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">id</span>: <span class="code-string">'push-base-image'</span>
                </div>
                <div class="code-line" data-explanation="push-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">waitFor</span>: [<span class="code-string">'build-base-image'</span>]
                </div>
                <div class="code-line" data-explanation="push-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">args</span>: 
                </div>
                <div class="code-line" data-explanation="push-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="code-string">'push'</span>
                </div>
                <div class="code-line" data-explanation="push-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="code-string">'${_REGION}-docker.pkg.dev/$PROJECT_ID/${_REPO_NAME}/${_IMAGE_NAME}:latest'</span>
                </div>
                <div class="code-line">&nbsp;</div>
                <div class="code-line" data-explanation="deploy-step">
                    &nbsp;&nbsp;<span class="code-comment"># Step 3: Deploy Service 1</span>
                </div>
                <div class="code-line" data-explanation="deploy-step">
                    &nbsp;&nbsp;- <span class="code-keyword">name</span>: <span class="code-string">'gcr.io/google.com/cloudsdktool/cloud-sdk'</span>
                </div>
                <div class="code-line" data-explanation="deploy-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">id</span>: <span class="code-string">'deploy-service-one'</span>
                </div>
                <div class="code-line" data-explanation="deploy-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">waitFor</span>: [<span class="code-string">'push-base-image'</span>]
                </div>
                <div class="code-line" data-explanation="deploy-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">entrypoint</span>: gcloud
                </div>
                <div class="code-line" data-explanation="deploy-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">args</span>:
                </div>
                <div class="code-line" data-explanation="deploy-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="code-string">'run'</span>
                </div>
                <div class="code-line" data-explanation="deploy-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="code-string">'deploy'</span>
                </div>
                <div class="code-line" data-explanation="deploy-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="code-string">'${_SERVICE_ONE_NAME}'</span>
                </div>
                <div class="code-line" data-explanation="deploy-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="code-string">'--image=${_REGION}-docker.pkg.dev/$PROJECT_ID/${_REPO_NAME}/${_IMAGE_NAME}:latest'</span>
                </div>
                <div class="code-line" data-explanation="deploy-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="code-string">'--region=${_REGION}'</span>
                </div>
                <div class="code-line" data-explanation="deploy-step">
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="code-string">'--allow-unauthenticated'</span>
                </div>
                <div class="code-line">&nbsp;</div>
                <div class="code-line" data-explanation="substitutions">
                    <span class="code-comment"># Substitution Variables</span>
                </div>
                <div class="code-line" data-explanation="substitutions">
                    <span class="code-keyword">substitutions</span>:
                </div>
                <div class="code-line" data-explanation="substitutions">
                    &nbsp;&nbsp;<span class="code-keyword">_PROJECT_ID</span>: <span class="code-string">"my-project-123"</span>
                </div>
                <div class="code-line" data-explanation="substitutions">
                    &nbsp;&nbsp;<span class="code-keyword">_REGION</span>: <span class="code-string">"us-central1"</span>
                </div>
                <div class="code-line" data-explanation="substitutions">
                    &nbsp;&nbsp;<span class="code-keyword">_REPO_NAME</span>: <span class="code-string">"my-app-repo"</span>
                </div>
                <div class="code-line" data-explanation="substitutions">
                    &nbsp;&nbsp;<span class="code-keyword">_IMAGE_NAME</span>: <span class="code-string">"multi-service-app"</span>
                </div>
                <div class="code-line" data-explanation="substitutions">
                    &nbsp;&nbsp;<span class="code-keyword">_SERVICE_ONE_NAME</span>: <span class="code-string">"api-service"</span>
                </div>
            </div>

            <div id="explanation-display" class="explanation-panel">
                <h4>Click on any line above to see explanations!</h4>
                <p>Each component of the Cloud Build template serves a specific purpose. Explore the interactive code to understand how each piece works together.</p>
            </div>
        </section>

        <section id="interactive-breakdown">
            <h2>Interactive Component Breakdown</h2>
            
            <div class="template-builder">
                <h3>Component Explorer</h3>
                <p>Select a component to learn about its purpose and configuration:</p>
                
                <div class="form-group">
                    <div class="form-control">
                        <label>Component Type</label>
                        <select id="componentSelect">
                            <option value="">Select a component...</option>
                            <option value="steps">Steps Section</option>
                            <option value="docker-build">Docker Build Step</option>
                            <option value="artifact-push">Artifact Registry Push</option>
                            <option value="cloud-run-deploy">Cloud Run Deployment</option>
                            <option value="substitutions">Substitution Variables</option>
                            <option value="waitfor">WaitFor Dependencies</option>
                            <option value="options">Build Options</option>
                        </select>
                    </div>
                    <div class="form-control">
                        <label>Complexity Level</label>
                        <select id="complexitySelect">
                            <option value="beginner">Beginner</option>
                            <option value="intermediate">Intermediate</option>
                            <option value="advanced">Advanced</option>
                        </select>
                    </div>
                </div>
                
                <button class="button" onclick="explainComponent()">Explain Component</button>
                
                <div id="component-explanation" class="explanation-panel">
                    <p>Select a component above to see detailed explanations, examples, and best practices.</p>
                </div>
            </div>
        </section>

        <section id="builder">
            <h2>Template Builder</h2>
            
            <div class="status-box warning">
                <p><strong>Interactive Template Generator:</strong> Fill in the details below to generate your custom Cloud Build template.</p>
            </div>

            <div class="template-builder">
                <div class="builder-section">
                    <h3>Project Configuration</h3>
                    <div class="form-group">
                        <div class="form-control">
                            <label for="projectId">Google Cloud Project ID</label>
                            <input type="text" id="projectId" placeholder="my-project-123" />
                        </div>
                        <div class="form-control">
                            <label for="region">Deployment Region</label>
                            <select id="region">
                                <option value="us-central1">us-central1</option>
                                <option value="us-east1">us-east1</option>
                                <option value="us-west1">us-west1</option>
                                <option value="europe-west1">europe-west1</option>
                                <option value="asia-northeast1">asia-northeast1</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <div class="form-control">
                            <label for="repoName">Artifact Registry Repository</label>
                            <input type="text" id="repoName" placeholder="my-app-repo" />
                        </div>
                        <div class="form-control">
                            <label for="imageName">Base Image Name</label>
                            <input type="text" id="imageName" placeholder="multi-service-app" />
                        </div>
                    </div>
                </div>

                <div class="builder-section">
                    <h3>Services Configuration</h3>
                    <div id="services-container">
                        <div class="service-config" data-service="1">
                            <h4>Service 1</h4>
                            <div class="form-group">
                                <div class="form-control">
                                    <label>Service Name</label>
                                    <input type="text" class="service-name" placeholder="api-service" />
                                </div>
                                <div class="form-control">
                                    <label>Folder Path</label>
                                    <input type="text" class="service-folder" placeholder="./backend/api" />
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="form-control">
                                    <label>Memory Allocation</label>
                                    <select class="service-memory">
                                        <option value="512Mi">512Mi</option>
                                        <option value="1Gi">1Gi</option>
                                        <option value="2Gi">2Gi</option>
                                        <option value="4Gi">4Gi</option>
                                    </select>
                                </div>
                                <div class="form-control">
                                    <label>CPU Allocation</label>
                                    <select class="service-cpu">
                                        <option value="1">1 CPU</option>
                                        <option value="2">2 CPU</option>
                                        <option value="4">4 CPU</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <button class="button button-secondary" onclick="addService()">Add Another Service</button>
                    <button class="button button-secondary" onclick="removeService()">Remove Last Service</button>
                </div>

                <div class="builder-section">
                    <h3>Environment Variables</h3>
                    <div id="env-vars-container">
                        <div class="form-group">
                            <div class="form-control">
                                <label>Variable Name</label>
                                <input type="text" class="env-name" placeholder="DATABASE_URL" />
                            </div>
                            <div class="form-control">
                                <label>Variable Value</label>
                                <input type="text" class="env-value" placeholder="postgres://..." />
                            </div>
                        </div>
                    </div>
                    
                    <button class="button button-secondary" onclick="addEnvVar()">Add Environment Variable</button>
                </div>

                <div class="builder-section">
                    <button class="button" onclick="generateTemplate()">Generate Cloud Build Template</button>
                    <button class="button button-secondary" onclick="resetBuilder()">Reset Form</button>
                </div>
            </div>

            <div id="generated-template" class="output-container" style="display: none;">
                <!-- Generated template will appear here -->
            </div>
        </section>

        <section id="quiz">
            <h2>Knowledge Quiz</h2>
            
            <div class="quiz-container">
                <div class="quiz-question">
                    What is the purpose of the "waitFor" parameter in Cloud Build steps?
                </div>
                <div class="quiz-options">
                    <div class="quiz-option" data-correct="false">To specify how long to wait before starting</div>
                    <div class="quiz-option" data-correct="true">To ensure steps run in the correct order by waiting for dependencies</div>
                    <div class="quiz-option" data-correct="false">To set a timeout for the step</div>
                    <div class="quiz-option" data-correct="false">To wait for user confirmation</div>
                </div>
                <div class="quiz-feedback">
                    <p><strong>Correct!</strong> The "waitFor" parameter ensures that steps execute in the proper sequence by waiting for specified step IDs to complete first.</p>
                </div>
            </div>

            <div class="quiz-container">
                <div class="quiz-question">
                    Which Google Cloud service is used to store Docker images in this template?
                </div>
                <div class="quiz-options">
                    <div class="quiz-option" data-correct="false">Cloud Storage</div>
                    <div class="quiz-option" data-correct="true">Artifact Registry</div>
                    <div class="quiz-option" data-correct="false">Container Registry</div>
                    <div class="quiz-option" data-correct="false">Cloud Run</div>
                </div>
                <div class="quiz-feedback">
                    <p><strong>Correct!</strong> Artifact Registry is Google Cloud's recommended service for storing Docker images and other build artifacts.</p>
                </div>
            </div>

            <div class="quiz-container">
                <div class="quiz-question">
                    What does the substitution variable syntax "${_REGION}" represent?
                </div>
                <div class="quiz-options">
                    <div class="quiz-option" data-correct="false">A hardcoded region name</div>
                    <div class="quiz-option" data-correct="true">A customizable variable that gets replaced during build</div>
                    <div class="quiz-option" data-correct="false">An environment variable from the build machine</div>
                    <div class="quiz-option" data-correct="false">A Google Cloud built-in variable</div>
                </div>
                <div class="quiz-feedback">
                    <p><strong>Correct!</strong> Substitution variables like "${_REGION}" are placeholders that get replaced with actual values from the substitutions section, making templates reusable.</p>
                </div>
            </div>
        </section>

        <section id="examples">
            <h2>Real-World Examples</h2>
            
            <div class="tabs">
                <div class="tab active" data-tab="ecommerce">E-commerce App</div>
                <div class="tab" data-tab="microservices">Microservices</div>
                <div class="tab" data-tab="fullstack">Full-Stack App</div>
            </div>

            <div id="ecommerce" class="tab-content active">
                <h3>E-commerce Application</h3>
                <p>A complete e-commerce system with API, frontend, and worker services:</p>
                
                <div class="interactive-code">
                    <button class="copy-button" onclick="copyCode()">Copy Code</button>
                    <div class="code-line">
                        <span class="code-keyword">steps</span>:
                    </div>
                    <div class="code-line">
                        <span class="code-comment"># Build user management API</span>
                    </div>
                    <div class="code-line">
                        - <span class="code-keyword">name</span>: <span class="code-string">'gcr.io/cloud-builders/docker'</span>
                    </div>
                    <div class="code-line">
                        &nbsp;&nbsp;<span class="code-keyword">id</span>: <span class="code-string">'build-user-api'</span>
                    </div>
                    <div class="code-line">
                        &nbsp;&nbsp;<span class="code-keyword">args</span>: [<span class="code-string">'build'</span>, <span class="code-string">'-t'</span>, <span class="code-string">'${_REGION}-docker.pkg.dev/$PROJECT_ID/ecommerce/user-api:latest'</span>, <span class="code-string">'./backend/users'</span>]
                    </div>
                    <div class="code-line">
                        <span class="code-comment"># Build product catalog API</span>
                    </div>
                    <div class="code-line">
                        - <span class="code-keyword">name</span>: <span class="code-string">'gcr.io/cloud-builders/docker'</span>
                    </div>
                    <div class="code-line">
                        &nbsp;&nbsp;<span class="code-keyword">id</span>: <span class="code-string">'build-product-api'</span>
                    </div>
                    <div class="code-line">
                        &nbsp;&nbsp;<span class="code-keyword">args</span>: [<span class="code-string">'build'</span>, <span class="code-string">'-t'</span>, <span class="code-string">'${_REGION}-docker.pkg.dev/$PROJECT_ID/ecommerce/product-api:latest'</span>, <span class="code-string">'./backend/products'</span>]
                    </div>
                </div>
            </div>

            <div id="microservices" class="tab-content">
                <h3>Microservices Architecture</h3>
                <p>Independent services that can scale separately:</p>
                
                <div class="interactive-code">
                    <button class="copy-button" onclick="copyCode()">Copy Code</button>
                    <div class="code-line">
                        <span class="code-keyword">substitutions</span>:
                    </div>
                    <div class="code-line">
                        &nbsp;&nbsp;<span class="code-keyword">_REGION</span>: <span class="code-string">"us-central1"</span>
                    </div>
                    <div class="code-line">
                        &nbsp;&nbsp;<span class="code-keyword">_AUTH_SERVICE</span>: <span class="code-string">"auth-microservice"</span>
                    </div>
                    <div class="code-line">
                        &nbsp;&nbsp;<span class="code-keyword">_PAYMENT_SERVICE</span>: <span class="code-string">"payment-microservice"</span>
                    </div>
                    <div class="code-line">
                        &nbsp;&nbsp;<span class="code-keyword">_NOTIFICATION_SERVICE</span>: <span class="code-string">"notification-microservice"</span>
                    </div>
                </div>
            </div>

            <div id="fullstack" class="tab-content">
                <h3>Full-Stack Application</h3>
                <p>Complete application with frontend, backend, and database:</p>
                
                <div class="interactive-code">
                    <button class="copy-button" onclick="copyCode()">Copy Code</button>
                    <div class="code-line">
                        <span class="code-comment"># Deploy with database connection</span>
                    </div>
                    <div class="code-line">
                        <span class="code-string">'--set-env-vars=DATABASE_URL=${_DATABASE_URL},API_KEY=${_API_KEY}'</span>
                    </div>
                    <div class="code-line">
                        <span class="code-string">'--set-cloudsql-instances=${_SQL_INSTANCE}'</span>
                    </div>
                    <div class="code-line">
                        <span class="code-string">'--memory=2Gi'</span>
                    </div>
                    <div class="code-line">
                        <span class="code-string">'--cpu=2'</span>
                    </div>
                </div>
            </div>
        </section>

        <section id="troubleshooting">
            <h2>Common Issues & Solutions</h2>
            
            <div class="status-box warning">
                <h4>Build Failed: Permission Denied</h4>
                <p><strong>Solution:</strong> Ensure Cloud Build service account has necessary IAM roles: Cloud Build Editor, Cloud Run Admin, Artifact Registry Writer.</p>
            </div>

            <div class="status-box info">
                <h4>Images Not Found</h4>
                <p><strong>Solution:</strong> Verify your Artifact Registry repository exists and the image names in substitutions match exactly.</p>
            </div>

            <div class="status-box warning">
                <h4>Deployment Timeout</h4>
                <p><strong>Solution:</strong> Increase timeout in build options or optimize your Docker images for faster startup.</p>
            </div>
        </section>
    </main>

    <script>
        // =====================================
        // INTERACTIVE CODE EXPLANATIONS
        // =====================================
        
        const explanations = {
            'header': {
                title: 'Template Header',
                content: `
                    <h4>Template Documentation</h4>
                    <p>The header comments provide essential information about:</p>
                    <ul>
                        <li><strong>Purpose:</strong> What this template accomplishes</li>
                        <li><strong>Prerequisites:</strong> What you need before using it</li>
                        <li><strong>Customization:</strong> How to adapt it for your project</li>
                    </ul>
                    <p>Always include clear documentation in your templates for team collaboration.</p>
                `
            },
            'steps-intro': {
                title: 'Steps Section',
                content: `
                    <h4>Build Steps Array</h4>
                    <p>The <code>steps</code> section defines the sequence of operations:</p>
                    <ul>
                        <li><strong>Sequential:</strong> Steps run one after another by default</li>
                        <li><strong>Parallel:</strong> Steps without dependencies can run simultaneously</li>
                        <li><strong>Ordered:</strong> Use <code>waitFor</code> to control execution order</li>
                    </ul>
                    <p>Each step represents a single build operation like building, pushing, or deploying.</p>
                `
            },
            'build-step': {
                title: 'Docker Build Step',
                content: `
                    <h4>Building Docker Images</h4>
                    <p>This step creates a Docker image from your source code:</p>
                    <ul>
                        <li><strong>Builder:</strong> <code>gcr.io/cloud-builders/docker</code> provides Docker CLI</li>
                        <li><strong>ID:</strong> Unique identifier for referencing in other steps</li>
                        <li><strong>Args:</strong> Docker build command arguments</li>
                        <li><strong>Tag:</strong> Image name and location in Artifact Registry</li>
                    </ul>
                    <p>The build context (<code>.</code>) includes all files in the current directory.</p>
                `
            },
            'push-step': {
                title: 'Image Push Step',
                content: `
                    <h4>Pushing to Artifact Registry</h4>
                    <p>This step uploads your built image to Google's container registry:</p>
                    <ul>
                        <li><strong>WaitFor:</strong> Ensures build completes before pushing</li>
                        <li><strong>Registry:</strong> Uses Artifact Registry for secure storage</li>
                        <li><strong>Versioning:</strong> Images are tagged for version control</li>
                    </ul>
                    <p>Pushed images are available for deployment across multiple services.</p>
                `
            },
            'deploy-step': {
                title: 'Cloud Run Deployment',
                content: `
                    <h4>Deploying to Cloud Run</h4>
                    <p>This step deploys your container to a managed serverless platform:</p>
                    <ul>
                        <li><strong>Service Name:</strong> The Cloud Run service identifier</li>
                        <li><strong>Region:</strong> Geographic location for deployment</li>
                        <li><strong>Scaling:</strong> Automatic scaling based on traffic</li>
                        <li><strong>Authentication:</strong> Configure public or private access</li>
                    </ul>
                    <p>Cloud Run automatically handles HTTPS, load balancing, and scaling.</p>
                `
            },
            'substitutions': {
                title: 'Substitution Variables',
                content: `
                    <h4>Template Variables</h4>
                    <p>Substitutions make templates reusable across environments:</p>
                    <ul>
                        <li><strong>Reusability:</strong> Same template, different configurations</li>
                        <li><strong>Security:</strong> Avoid hardcoding sensitive values</li>
                        <li><strong>Flexibility:</strong> Easy environment switching</li>
                        <li><strong>Maintenance:</strong> Update values in one place</li>
                    </ul>
                    <p>Variables can be overridden when triggering builds manually or via triggers.</p>
                `
            }
        };

        // Handle code line clicks
        document.querySelectorAll('.code-line[data-explanation]').forEach(line => {
            line.addEventListener('click', function() {
                const explanationType = this.dataset.explanation;
                const explanation = explanations[explanationType];
                
                if (explanation) {
                    // Remove previous highlights
                    document.querySelectorAll('.code-line.highlighted').forEach(el => {
                        el.classList.remove('highlighted');
                    });
                    
                    // Highlight clicked lines with same explanation
                    document.querySelectorAll(`[data-explanation="${explanationType}"]`).forEach(el => {
                        el.classList.add('highlighted');
                    });
                    
                    // Show explanation
                    const panel = document.getElementById('explanation-display');
                    panel.innerHTML = `
                        <h4>${explanation.title}</h4>
                        ${explanation.content}
                    `;
                    panel.classList.add('active');
                }
            });
        });

        // =====================================
        // COMPONENT EXPLANATION SYSTEM
        // =====================================
        
        const componentExplanations = {
            'steps': {
                beginner: `
                    <h4>Steps: The Heart of Cloud Build</h4>
                    <p>Think of steps like a recipe - they tell Cloud Build exactly what to do and in what order.</p>
                    <p><strong>Basic Structure:</strong></p>
                    <ul>
                        <li>Each step is a single task (build, push, deploy)</li>
                        <li>Steps run one after another unless you specify otherwise</li>
                        <li>Every step needs a "name" (which tool to use) and "args" (what to do)</li>
                    </ul>
                    <p><strong>Example:</strong> Like cooking, you can't frost a cake before baking it!</p>
                `,
                intermediate: `
                    <h4>Steps: Advanced Orchestration</h4>
                    <p>Steps are build operations that can run sequentially or in parallel for optimized performance.</p>
                    <p><strong>Key Features:</strong></p>
                    <ul>
                        <li><strong>Dependencies:</strong> Use waitFor to control execution order</li>
                        <li><strong>Parallel Execution:</strong> Independent steps run simultaneously</li>
                        <li><strong>Error Handling:</strong> Failed steps stop the entire build</li>
                        <li><strong>Resource Sharing:</strong> Steps share the build workspace</li>
                    </ul>
                    <p><strong>Best Practice:</strong> Group related operations and minimize dependencies for faster builds.</p>
                `,
                advanced: `
                    <h4>Steps: Enterprise Build Orchestration</h4>
                    <p>Advanced step configuration for complex enterprise deployments.</p>
                    <p><strong>Advanced Patterns:</strong></p>
                    <ul>
                        <li><strong>Conditional Steps:</strong> Use branch/tag conditions</li>
                        <li><strong>Matrix Builds:</strong> Build multiple variants simultaneously</li>
                        <li><strong>Custom Builders:</strong> Create specialized build containers</li>
                        <li><strong>Secret Management:</strong> Secure handling of credentials</li>
                    </ul>
                    <p><strong>Performance:</strong> Optimize with multi-stage builds and caching strategies.</p>
                `
            },
            'docker-build': {
                beginner: `
                    <h4>Docker Build: Creating Container Images</h4>
                    <p>Docker build turns your code into a portable container that can run anywhere.</p>
                    <p><strong>What Happens:</strong></p>
                    <ul>
                        <li>Cloud Build reads your Dockerfile</li>
                        <li>Installs dependencies and copies your code</li>
                        <li>Creates a ready-to-run container image</li>
                        <li>Tags it with a name for easy identification</li>
                    </ul>
                    <p><strong>Think of it as:</strong> Packaging your app with everything it needs to run.</p>
                `,
                intermediate: `
                    <h4>Docker Build: Optimization Strategies</h4>
                    <p>Efficient Docker builds reduce deployment time and costs.</p>
                    <p><strong>Optimization Techniques:</strong></p>
                    <ul>
                        <li><strong>Layer Caching:</strong> Reuse unchanged layers between builds</li>
                        <li><strong>Multi-stage Builds:</strong> Separate build and runtime environments</li>
                        <li><strong>.dockerignore:</strong> Exclude unnecessary files from build context</li>
                        <li><strong>Base Image Selection:</strong> Choose minimal, secure base images</li>
                    </ul>
                    <p><strong>Security:</strong> Scan images for vulnerabilities and use distroless images when possible.</p>
                `,
                advanced: `
                    <h4>Docker Build: Enterprise Patterns</h4>
                    <p>Advanced Docker building for enterprise-scale applications.</p>
                    <p><strong>Enterprise Features:</strong></p>
                    <ul>
                        <li><strong>BuildKit:</strong> Enhanced build performance and features</li>
                        <li><strong>Build Arguments:</strong> Dynamic configuration during build</li>
                        <li><strong>Cross-platform Builds:</strong> Support multiple architectures</li>
                        <li><strong>Registry Mirroring:</strong> Reduce external dependencies</li>
                    </ul>
                    <p><strong>Compliance:</strong> Implement signing, scanning, and audit trails for images.</p>
                `
            },
            'artifact-push': {
                beginner: `
                    <h4>Artifact Registry: Storing Your Images</h4>
                    <p>After building, your images need to be stored securely for deployment.</p>
                    <p><strong>What Artifact Registry Does:</strong></p>
                    <ul>
                        <li>Stores Docker images securely in Google Cloud</li>
                        <li>Provides version control for your container images</li>
                        <li>Integrates with Cloud Run for seamless deployment</li>
                        <li>Scans images for security vulnerabilities</li>
                    </ul>
                    <p><strong>Benefits:</strong> Reliable, secure, and fast image distribution.</p>
                `,
                intermediate: `
                    <h4>Artifact Registry: Advanced Management</h4>
                    <p>Strategic container image management for production environments.</p>
                    <p><strong>Management Features:</strong></p>
                    <ul>
                        <li><strong>Repository Organization:</strong> Group related images logically</li>
                        <li><strong>Access Control:</strong> Fine-grained permissions per repository</li>
                        <li><strong>Cleanup Policies:</strong> Automatic deletion of old images</li>
                        <li><strong>Vulnerability Scanning:</strong> Automated security assessments</li>
                    </ul>
                    <p><strong>Cost Optimization:</strong> Implement lifecycle policies to manage storage costs.</p>
                `,
                advanced: `
                    <h4>Artifact Registry: Enterprise Integration</h4>
                    <p>Enterprise-grade container registry management and governance.</p>
                    <p><strong>Enterprise Capabilities:</strong></p>
                    <ul>
                        <li><strong>Binary Authorization:</strong> Enforce deployment policies</li>
                        <li><strong>Image Attestation:</strong> Cryptographic proof of build integrity</li>
                        <li><strong>Multi-region Replication:</strong> Global image distribution</li>
                        <li><strong>CMEK Integration:</strong> Customer-managed encryption keys</li>
                    </ul>
                    <p><strong>Compliance:</strong> Meet regulatory requirements with audit logs and governance controls.</p>
                `
            },
            'cloud-run-deploy': {
                beginner: `
                    <h4>Cloud Run: Serverless Container Deployment</h4>
                    <p>Cloud Run runs your containers without managing servers.</p>
                    <p><strong>Key Benefits:</strong></p>
                    <ul>
                        <li><strong>Serverless:</strong> No server management required</li>
                        <li><strong>Auto-scaling:</strong> Scales from 0 to thousands of instances</li>
                        <li><strong>Pay-per-use:</strong> Only pay when requests are being processed</li>
                        <li><strong>HTTPS Built-in:</strong> Automatic SSL certificates</li>
                    </ul>
                    <p><strong>Perfect for:</strong> APIs, web apps, and microservices that need to scale automatically.</p>
                `,
                intermediate: `
                    <h4>Cloud Run: Performance Configuration</h4>
                    <p>Optimize Cloud Run services for performance and cost efficiency.</p>
                    <p><strong>Configuration Options:</strong></p>
                    <ul>
                        <li><strong>Resource Allocation:</strong> CPU and memory tuning per service</li>
                        <li><strong>Concurrency:</strong> Requests per instance optimization</li>
                        <li><strong>Min/Max Instances:</strong> Control scaling behavior</li>
                        <li><strong>Request Timeout:</strong> Set appropriate timeout limits</li>
                    </ul>
                    <p><strong>Monitoring:</strong> Use Cloud Monitoring to track performance and costs.</p>
                `,
                advanced: `
                    <h4>Cloud Run: Enterprise Deployment</h4>
                    <p>Advanced Cloud Run patterns for enterprise production workloads.</p>
                    <p><strong>Enterprise Features:</strong></p>
                    <ul>
                        <li><strong>VPC Connectivity:</strong> Private network integration</li>
                        <li><strong>Identity-Aware Proxy:</strong> Advanced authentication</li>
                        <li><strong>Cloud SQL Integration:</strong> Secure database connections</li>
                        <li><strong>Canary Deployments:</strong> Traffic splitting for safe releases</li>
                    </ul>
                    <p><strong>Best Practices:</strong> Implement health checks, graceful shutdowns, and observability.</p>
                `
            },
            'substitutions': {
                beginner: `
                    <h4>Substitutions: Making Templates Reusable</h4>
                    <p>Substitutions are like variables that make your template work for different projects.</p>
                    <p><strong>How They Work:</strong></p>
                    <ul>
                        <li>Define variables in the substitutions section</li>
                        <li>Use them throughout your template with <code>\${_VARIABLE_NAME}</code></li>
                        <li>Change values without editing the entire template</li>
                        <li>Override them when triggering builds</li>
                    </ul>
                    <p><strong>Example:</strong> Use <code>\${_REGION}</code> instead of hardcoding "us-central1".</p>
                `,
                intermediate: `
                    <h4>Substitutions: Dynamic Configuration</h4>
                    <p>Advanced substitution patterns for flexible template management.</p>
                    <p><strong>Advanced Usage:</strong></p>
                    <ul>
                        <li><strong>Built-in Variables:</strong> \$PROJECT_ID, \$BUILD_ID, \$COMMIT_SHA</li>
                        <li><strong>Conditional Logic:</strong> Different values based on branch/tag</li>
                        <li><strong>Nested Substitutions:</strong> Variables that reference other variables</li>
                        <li><strong>Default Values:</strong> Fallbacks when variables aren't provided</li>
                    </ul>
                    <p><strong>Organization:</strong> Group related variables and use clear naming conventions.</p>
                `,
                advanced: `
                    <h4>Substitutions: Enterprise Variable Management</h4>
                    <p>Strategic variable management for large-scale deployment automation.</p>
                    <p><strong>Enterprise Patterns:</strong></p>
                    <ul>
                        <li><strong>Secret Manager Integration:</strong> Secure credential handling</li>
                        <li><strong>Environment Promotion:</strong> Dev â†’ Staging â†’ Production workflows</li>
                        <li><strong>Template Inheritance:</strong> Shared base configurations</li>
                        <li><strong>Validation Rules:</strong> Ensure variable consistency</li>
                    </ul>
                    <p><strong>Governance:</strong> Implement approval workflows for production variables.</p>
                `
            },
            'waitfor': {
                beginner: `
                    <h4>WaitFor: Controlling Step Order</h4>
                    <p>WaitFor ensures steps happen in the right sequence.</p>
                    <p><strong>Why It's Important:</strong></p>
                    <ul>
                        <li>You can't push an image before building it</li>
                        <li>You can't deploy before the image is available</li>
                        <li>Some steps depend on others completing first</li>
                    </ul>
                    <p><strong>Usage:</strong> <code>waitFor: ['step-id-1', 'step-id-2']</code></p>
                `,
                intermediate: `
                    <h4>WaitFor: Dependency Management</h4>
                    <p>Strategic dependency management for optimized build performance.</p>
                    <p><strong>Optimization Strategies:</strong></p>
                    <ul>
                        <li><strong>Parallel Execution:</strong> Independent steps run simultaneously</li>
                        <li><strong>Critical Path:</strong> Identify and optimize the longest dependency chain</li>
                        <li><strong>Resource Contention:</strong> Avoid too many parallel steps</li>
                    </ul>
                    <p><strong>Pattern:</strong> Group dependencies logically to minimize total build time.</p>
                `,
                advanced: `
                    <h4>WaitFor: Complex Workflow Orchestration</h4>
                    <p>Advanced dependency management for enterprise build pipelines.</p>
                    <p><strong>Complex Patterns:</strong></p>
                    <ul>
                        <li><strong>Diamond Dependencies:</strong> Multiple paths converging</li>
                        <li><strong>Conditional Workflows:</strong> Steps that run based on conditions</li>
                        <li><strong>Fan-out/Fan-in:</strong> Parallel processing with synchronization</li>
                    </ul>
                    <p><strong>Monitoring:</strong> Track dependency performance and bottlenecks.</p>
                `
            },
            'options': {
                beginner: `
                    <h4>Build Options: Customizing Your Build Environment</h4>
                    <p>Build options let you customize how Cloud Build executes your template.</p>
                    <p><strong>Common Options:</strong></p>
                    <ul>
                        <li><strong>Machine Type:</strong> Choose more powerful build machines for faster builds</li>
                        <li><strong>Logging:</strong> Control where build logs are stored</li>
                        <li><strong>Timeout:</strong> Set maximum build duration</li>
                        <li><strong>Substitution Option:</strong> Control how missing variables are handled</li>
                    </ul>
                    <p><strong>Example:</strong> Use a high-CPU machine for faster Docker builds.</p>
                `,
                intermediate: `
                    <h4>Build Options: Advanced Configuration</h4>
                    <p>Advanced build configuration for optimizing performance and cost.</p>
                    <p><strong>Advanced Options:</strong></p>
                    <ul>
                        <li><strong>Disk Size:</strong> Increase disk space for large builds</li>
                        <li><strong>Worker Pool:</strong> Use private worker pools for security</li>
                        <li><strong>Default Logs Bucket:</strong> Customize log storage location</li>
                        <li><strong>Env Variables:</strong> Set environment variables for all steps</li>
                    </ul>
                    <p><strong>Cost Optimization:</strong> Choose appropriate machine types to balance speed and cost.</p>
                `,
                advanced: `
                    <h4>Build Options: Enterprise Configuration</h4>
                    <p>Enterprise-grade build configuration for compliance and security.</p>
                    <p><strong>Enterprise Features:</strong></p>
                    <ul>
                        <li><strong>Service Account:</strong> Use custom service accounts with specific permissions</li>
                        <li><strong>Network Configuration:</strong> Control network access and egress</li>
                        <li><strong>Secret Management:</strong> Integrate with Secret Manager for credentials</li>
                        <li><strong>Audit Logging:</strong> Comprehensive audit trails for compliance</li>
                    </ul>
                    <p><strong>Security:</strong> Implement least-privilege access and network isolation.</p>
                `
            }
        };

        // Handle component explanation
        function explainComponent() {
            const componentType = document.getElementById('componentSelect').value;
            const complexity = document.getElementById('complexitySelect').value;
            
            if (!componentType) {
                alert('Please select a component to explain');
                return;
            }
            
            const explanation = componentExplanations[componentType][complexity];
            const panel = document.getElementById('component-explanation');
            
            if (explanation) {
                panel.innerHTML = explanation;
                panel.classList.add('active');
            } else {
                panel.innerHTML = '<p>No explanation available for this component.</p>';
                panel.classList.add('active');
            }
        }

        // =====================================
        // TEMPLATE BUILDER FUNCTIONALITY
        // =====================================
        
        let serviceCount = 1;
        let envVarCount = 1;
        
        function addService() {
            serviceCount++;
            const servicesContainer = document.getElementById('services-container');
            
            const newService = document.createElement('div');
            newService.className = 'service-config';
            newService.dataset.service = serviceCount;
            
            newService.innerHTML = `
                <h4>Service ${serviceCount}</h4>
                <div class="form-group">
                    <div class="form-control">
                        <label>Service Name</label>
                        <input type="text" class="service-name" placeholder="service-${serviceCount}" />
                    </div>
                    <div class="form-control">
                        <label>Folder Path</label>
                        <input type="text" class="service-folder" placeholder="./service-${serviceCount}" />
                    </div>
                </div>
                <div class="form-group">
                    <div class="form-control">
                        <label>Memory Allocation</label>
                        <select class="service-memory">
                            <option value="512Mi">512Mi</option>
                            <option value="1Gi">1Gi</option>
                            <option value="2Gi">2Gi</option>
                            <option value="4Gi">4Gi</option>
                        </select>
                    </div>
                    <div class="form-control">
                        <label>CPU Allocation</label>
                        <select class="service-cpu">
                            <option value="1">1 CPU</option>
                            <option value="2">2 CPU</option>
                            <option value="4">4 CPU</option>
                        </select>
                    </div>
                </div>
            `;
            
            servicesContainer.appendChild(newService);
        }
        
        function removeService() {
            if (serviceCount > 1) {
                const servicesContainer = document.getElementById('services-container');
                servicesContainer.removeChild(servicesContainer.lastChild);
                serviceCount--;
            }
        }
        
        function addEnvVar() {
            envVarCount++;
            const envVarsContainer = document.getElementById('env-vars-container');
            
            const newEnvVar = document.createElement('div');
            newEnvVar.className = 'form-group';
            
            newEnvVar.innerHTML = `
                <div class="form-control">
                    <label>Variable Name</label>
                    <input type="text" class="env-name" placeholder="ENV_VAR_${envVarCount}" />
                </div>
                <div class="form-control">
                    <label>Variable Value</label>
                    <input type="text" class="env-value" placeholder="value_${envVarCount}" />
                </div>
            `;
            
            envVarsContainer.appendChild(newEnvVar);
        }
        
        function generateTemplate() {
            const projectId = document.getElementById('projectId').value || 'my-project-123';
            const region = document.getElementById('region').value || 'us-central1';
            const repoName = document.getElementById('repoName').value || 'my-app-repo';
            const imageName = document.getElementById('imageName').value || 'multi-service-app';
            
            // Collect services
            const services = [];
            const serviceConfigs = document.querySelectorAll('.service-config');
            
            serviceConfigs.forEach((config, index) => {
                const serviceName = config.querySelector('.service-name').value || `service-${index + 1}`;
                const serviceFolder = config.querySelector('.service-folder').value || `./service-${index + 1}`;
                const serviceMemory = config.querySelector('.service-memory').value || '512Mi';
                const serviceCpu = config.querySelector('.service-cpu').value || '1';
                
                services.push({
                    name: serviceName,
                    folder: serviceFolder,
                    memory: serviceMemory,
                    cpu: serviceCpu
                });
            });
            
            // Collect environment variables
            const envVars = {};
            const envNames = document.querySelectorAll('.env-name');
            const envValues = document.querySelectorAll('.env-value');
            
            for (let i = 0; i < envNames.length; i++) {
                const name = envNames[i].value;
                const value = envValues[i].value;
                if (name && value) {
                    envVars[name] = value;
                }
            }
            
            // Generate the YAML template
            let yamlTemplate = `# =============================================================================
# GENERATED CLOUD BUILD TEMPLATE
# =============================================================================
# This template was generated using the interactive template builder

steps:\n`;

            // Add build steps for each service
            services.forEach(service => {
                yamlTemplate += `
# Build ${service.name}
- name: 'gcr.io/cloud-builders/docker'
  id: 'build-${service.name}'
  args:
    - 'build'
    - '-t'
    - '${region}-docker.pkg.dev/${projectId}/${repoName}/${service.name}:latest'
    - '${service.folder}'\n`;
            });

            // Add push steps for each service
            services.forEach(service => {
                yamlTemplate += `
# Push ${service.name} to Artifact Registry
- name: 'gcr.io/cloud-builders/docker'
  id: 'push-${service.name}'
  waitFor: ['build-${service.name}']
  args:
    - 'push'
    - '${region}-docker.pkg.dev/${projectId}/${repoName}/${service.name}:latest'\n`;
            });

            // Add deploy steps for each service
            services.forEach(service => {
                yamlTemplate += `
# Deploy ${service.name} to Cloud Run
- name: 'gcr.io/google.com/cloudsdktool/cloud-sdk'
  id: 'deploy-${service.name}'
  waitFor: ['push-${service.name}']
  entrypoint: gcloud
  args:
    - 'run'
    - 'deploy'
    - '${service.name}'
    - '--image=${region}-docker.pkg.dev/${projectId}/${repoName}/${service.name}:latest'
    - '--region=${region}'
    - '--platform=managed'
    - '--memory=${service.memory}'
    - '--cpu=${service.cpu}'
    - '--allow-unauthenticated'\n`;
                
                // Add environment variables if any
                const envVarsString = Object.entries(envVars)
                    .map(([key, value]) => `${key}=${value}`)
                    .join(',');
                
                if (envVarsString) {
                    yamlTemplate += `    - '--set-env-vars=${envVarsString}'\n`;
                }
            });

            yamlTemplate += `
# Substitution Variables
substitutions:
  _PROJECT_ID: "${projectId}"
  _REGION: "${region}"
  _REPO_NAME: "${repoName}"
  _IMAGE_NAME: "${imageName}"\n`;

            // Add service names to substitutions
            services.forEach((service, index) => {
                yamlTemplate += `  _SERVICE_${index + 1}_NAME: "${service.name}"\n`;
            });

            // Add environment variables to substitutions
            Object.entries(envVars).forEach(([key, value]) => {
                yamlTemplate += `  _${key}: "${value}"\n`;
            });

            // Display the generated template
            const outputContainer = document.getElementById('generated-template');
            outputContainer.textContent = yamlTemplate;
            outputContainer.style.display = 'block';
        }
        
        function resetBuilder() {
            document.getElementById('projectId').value = '';
            document.getElementById('repoName').value = '';
            document.getElementById('imageName').value = '';
            
            // Reset services to just one
            const servicesContainer = document.getElementById('services-container');
            while (servicesContainer.children.length > 1) {
                servicesContainer.removeChild(servicesContainer.lastChild);
            }
            serviceCount = 1;
            
            // Reset the first service inputs
            const firstService = servicesContainer.querySelector('.service-config');
            firstService.querySelector('.service-name').value = '';
            firstService.querySelector('.service-folder').value = '';
            firstService.querySelector('.service-memory').value = '512Mi';
            firstService.querySelector('.service-cpu').value = '1';
            
            // Reset environment variables
            const envVarsContainer = document.getElementById('env-vars-container');
            while (envVarsContainer.children.length > 1) {
                envVarsContainer.removeChild(envVarsContainer.lastChild);
            }
            envVarCount = 1;
            
            // Reset the first env var inputs
            const firstEnvName = envVarsContainer.querySelector('.env-name');
            const firstEnvValue = envVarsContainer.querySelector('.env-value');
            if (firstEnvName) firstEnvName.value = '';
            if (firstEnvValue) firstEnvValue.value = '';
            
            // Hide output
            document.getElementById('generated-template').style.display = 'none';
        }

        // =====================================
        // QUIZ FUNCTIONALITY
        // =====================================
        
        document.querySelectorAll('.quiz-option').forEach(option => {
            option.addEventListener('click', function() {
                const isCorrect = this.dataset.correct === 'true';
                const feedback = this.parentElement.nextElementSibling;
                
                // Remove any existing selections
                this.parentElement.querySelectorAll('.quiz-option').forEach(opt => {
                    opt.classList.remove('correct', 'incorrect');
                });
                
                // Mark this option
                this.classList.add(isCorrect ? 'correct' : 'incorrect');
                
                // Show feedback
                feedback.classList.add('show');
                
                // If incorrect, highlight the correct answer
                if (!isCorrect) {
                    this.parentElement.querySelector('[data-correct="true"]').classList.add('correct');
                }
            });
        });

        // =====================================
        // TAB FUNCTIONALITY
        // =====================================
        
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const tabName = this.dataset.tab;
                
                // Remove active class from all tabs and contents
                this.parentElement.querySelectorAll('.tab').forEach(t => {
                    t.classList.remove('active');
                });
                
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                // Add active class to clicked tab and corresponding content
                this.classList.add('active');
                document.getElementById(tabName).classList.add('active');
            });
        });

        // =====================================
        // COPY CODE FUNCTIONALITY
        // =====================================
        
        function copyCode() {
            const codeElement = this.parentElement;
            const textToCopy = codeElement.textContent;
            
            navigator.clipboard.writeText(textToCopy).then(() => {
                const originalText = this.textContent;
                this.textContent = 'Copied!';
                
                setTimeout(() => {
                    this.textContent = originalText;
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy: ', err);
            });
        }
        
        // Attach copy functionality to all copy buttons
        document.querySelectorAll('.copy-button').forEach(button => {
            button.addEventListener('click', copyCode);
        });
    </script>
</body>
</html>
