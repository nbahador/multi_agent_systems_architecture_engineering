<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Agent System Template - Interactive Textbook</title>
    <style>
        /* Base Styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #ffffff;
        }
        
        /* Layout */
        .container {
            display: grid;
            grid-template-columns: 300px 1fr;
            min-height: 100vh;
        }
        
        /* Table of Contents */
        .toc {
            background-color: #f8f9fa;
            padding: 20px;
            border-right: 1px solid #e9ecef;
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
        }
        
        .toc h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }
        
        .toc ul {
            list-style-type: none;
        }
        
        .toc li {
            margin-bottom: 10px;
        }
        
        .toc a {
            color: #3498db;
            text-decoration: none;
            font-size: 1.1rem;
            display: block;
            padding: 8px 12px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        
        .toc a:hover {
            color: #2980b9;
            background-color: #e9ecef;
        }
        
        /* Main Content */
        .content {
            padding: 40px;
            max-width: 1200px;
        }
        
        /* Headings */
        h1 {
            font-size: 2.5rem;
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #3498db;
        }
        
        h2 {
            font-size: 2rem;
            color: #2c3e50;
            margin: 40px 0 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ecf0f1;
        }
        
        h3 {
            font-size: 1.5rem;
            color: #34495e;
            margin: 30px 0 15px;
        }
        
        /* Text Elements */
        p {
            margin-bottom: 20px;
        }
        
        /* Code Blocks */
        .code-block {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
        }
        
        .code-comment {
            color: #95a5a6;
            font-style: italic;
        }
        
        .code-keyword {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .code-string {
            color: #4ecdc4;
        }
        
        .code-number {
            color: #f39c12;
        }
        
        .code-python {
            color: #ff6b6b;
        }
        
        /* Two-column Code Explanation */
        .code-explanation {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin: 30px 0;
        }
        
        /* Demo Boxes */
        .demo-box {
            background-color: #f1f2f6;
            border: 1px solid #3498db;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .input-box {
            background-color: #ffffff;
            border-left: 4px solid #27ae60;
            padding: 15px;
            margin: 15px 0;
        }
        
        .output-box {
            background-color: #fdf2f2;
            border-left: 4px solid #e74c3c;
            padding: 15px;
            margin: 15px 0;
        }
        
        /* Status Boxes */
        .status-box {
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            border-left: 4px solid;
        }
        
        .warning {
            background-color: #fff3cd;
            border-left-color: #f39c12;
        }
        
        .info {
            background-color: #d1ecf1;
            border-left-color: #17a2b8;
        }
        
        .success {
            background-color: #d4edda;
            border-left-color: #28a745;
        }
        
        /* Flow Diagram */
        .flow-diagram {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            margin: 30px 0;
            gap: 10px;
        }
        
        .flow-box {
            background-color: #3498db;
            color: white;
            padding: 15px;
            border-radius: 6px;
            text-align: center;
            min-width: 100px;
        }
        
        .flow-arrow {
            font-size: 1.5rem;
            color: #2c3e50;
        }
        
        /* Buttons */
        .button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
        }
        
        .button:hover {
            background-color: #2980b9;
        }
        
        /* Collapsible Sections */
        .collapsible {
            background-color: #f8f9fa;
            border-radius: 8px 8px 0 0;
            margin-top: 30px;
        }
        
        .collapsible-header {
            padding: 15px 20px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #f8f9fa;
            border-radius: 8px 8px 0 0;
        }
        
        .collapsible-header::after {
            content: '▶';
            font-size: 0.8rem;
        }
        
        .collapsible-header.active::after {
            content: '▼';
        }
        
        .collapsible-content {
            padding: 0 20px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.2s ease-out;
            background-color: white;
        }
        
        .collapsible-content.active {
            padding: 20px;
            max-height: 1000px;
            border: 1px solid #e9ecef;
            border-top: none;
            border-radius: 0 0 8px 8px;
        }
        
        /* Interactive Elements */
        .interactive-demo {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        
        .code-input {
            width: 100%;
            height: 100px;
            padding: 10px;
            font-family: 'Courier New', monospace;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .toc {
                position: static;
                height: auto;
                border-right: none;
                border-bottom: 1px solid #e9ecef;
            }
            
            .content {
                padding: 20px;
            }
            
            .code-explanation {
                grid-template-columns: 1fr;
            }
            
            .flow-diagram {
                flex-direction: column;
            }
            
            .flow-arrow {
                transform: rotate(90deg);
                margin: 10px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Table of Contents -->
        <nav class="toc">
            <h2>Table of Contents</h2>
            <ul>
                <li><a href="#intro">Introduction</a></li>
                <li><a href="#base-image">Base Image Selection</a></li>
                <li><a href="#working-directory">Working Directory Setup</a></li>
                <li><a href="#dependencies">Dependency Installation</a></li>
                <li><a href="#application-code">Application Code Copy</a></li>
                <li><a href="#environment">Environment Variables</a></li>
                <li><a href="#exposing-ports">Exposing Ports</a></li>
                <li><a href="#entrypoint">Entrypoint Configuration</a></li>
                <li><a href="#interactive-demo">Interactive Demo</a></li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="content">
            <h1>Multi-Agent System Template Guide</h1>
            
            <section id="intro">
                <h2>Introduction to Multi-Agent Systems</h2>
                <p>Welcome to the interactive guide for building and deploying multi-agent systems using Docker. This textbook will walk you through each component of the Dockerfile template, explaining the purpose and implementation details.</p>
                
                <div class="status-box info">
                    <p><strong>Note:</strong> This guide assumes basic familiarity with Docker concepts. If you're new to Docker, we recommend checking out the official Docker documentation first.</p>
                </div>
                
                <div class="flow-diagram">
                    <div class="flow-box">Development</div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-box">Containerization</div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-box">Deployment</div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-box">Execution</div>
                </div>
            </section>
            
            <section id="base-image">
                <h2>1. Base Image Selection</h2>
                <p>The first step in containerizing your application is selecting an appropriate base image. This determines the operating system and Python version your application will run on.</p>
                
                <div class="code-explanation">
                    <div class="code-block">
                        <span class="code-comment"># Choose your Python version based on your project requirements</span><br>
                        <span class="code-comment"># Common options:</span><br>
                        <span class="code-comment">#   - python:3.12-slim (latest, smaller size)</span><br>
                        <span class="code-comment">#   - python:3.11-slim (stable, widely supported)</span><br>
                        <span class="code-comment">#   - python:3.10-slim (older but very stable)</span><br>
                        <span class="code-comment">#   - python:3.12 (full version with more tools, larger size)</span><br>
                        <br>
                        <span class="code-keyword">FROM</span> <span class="code-string">python:3.12-slim</span><br>
                        <span class="code-comment"># ↑ CUSTOMIZE: Replace with your preferred Python version</span>
                    </div>
                    
                    <div>
                        <h3>Explanation</h3>
                        <p>The <code>FROM</code> instruction initializes a new build stage and sets the base image for subsequent instructions.</p>
                        
                        <div class="status-box warning">
                            <p><strong>Considerations:</strong></p>
                            <ul>
                                <li><strong>Slim images</strong> are smaller but may miss some dependencies</li>
                                <li><strong>Full images</strong> are larger but include more tools</li>
                                <li>Match your Python version with your development environment</li>
                            </ul>
                        </div>
                        
                        <div class="demo-box">
                            <h4>Try It: Select a Base Image</h4>
                            <select id="baseImageSelect" class="code-input">
                                <option value="python:3.12-slim">python:3.12-slim (recommended)</option>
                                <option value="python:3.12">python:3.12 (full)</option>
                                <option value="python:3.11-slim">python:3.11-slim</option>
                                <option value="python:3.10-slim">python:3.10-slim</option>
                            </select>
                            <button class="button" onclick="updateBaseImage()">Update Dockerfile</button>
                            <div class="output-box" id="baseImageOutput">
                                Current selection: python:3.12-slim
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="working-directory">
                <h2>2. Working Directory Setup</h2>
                <p>The working directory is where your application code will reside inside the container.</p>
                
                <div class="code-explanation">
                    <div class="code-block">
                        <span class="code-comment"># Sets where your application will live inside the container</span><br>
                        <span class="code-comment"># Standard practice is /app, but you can change it</span><br>
                        <br>
                        <span class="code-keyword">WORKDIR</span> <span class="code-string">/app</span><br>
                        <span class="code-comment"># ↑ CUSTOMIZE: Change to your preferred directory (e.g., /myapp, /src)</span>
                    </div>
                    
                    <div>
                        <h3>Explanation</h3>
                        <p>The <code>WORKDIR</code> instruction sets the working directory for any RUN, CMD, ENTRYPOINT, COPY, and ADD instructions that follow it.</p>
                        
                        <div class="status-box info">
                            <p><strong>Best Practice:</strong> Use absolute paths for your WORKDIR to avoid confusion. The directory will be created if it doesn't exist.</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="dependencies">
                <h2>3. Dependency Installation</h2>
                <p>Proper dependency management is crucial for reproducible builds. This section handles installing your Python dependencies.</p>
                
                <div class="code-explanation">
                    <div class="code-block">
                        <span class="code-comment"># Copy requirements file first for better Docker layer caching</span><br>
                        <span class="code-comment"># This means dependencies only reinstall when requirements.txt changes</span><br>
                        <br>
                        <span class="code-keyword">COPY</span> <span class="code-string">requirements.txt /app/requirements.txt</span><br>
                        <span class="code-comment"># ↑ CUSTOMIZE: Replace 'requirements.txt' with your dependency file name</span><br>
                        <span class="code-comment">#              Options: requirements.txt, pyproject.toml, Pipfile, etc.</span><br>
                        <br>
                        <span class="code-comment"># Install Python dependencies</span><br>
                        <span class="code-keyword">RUN</span> <span class="code-string">pip install --no-cache-dir -r requirements.txt</span><br>
                        <span class="code-comment"># ↑ CUSTOMIZE: Modify installation command based on your setup:</span><br>
                        <span class="code-comment">#              - For pip: pip install --no-cache-dir -r requirements.txt</span><br>
                        <span class="code-comment">#              - For poetry: pip install poetry && poetry install --no-dev</span><br>
                        <span class="code-comment">#              - For pipenv: pip install pipenv && pipenv install --system</span>
                    </div>
                    
                    <div>
                        <h3>Explanation</h3>
                        <p>This section uses Docker's layer caching to optimize build times. By copying the requirements file first and installing dependencies separately, Docker can cache this layer and only rebuild it when the requirements change.</p>
                        
                        <div class="status-box success">
                            <p><strong>Performance Tip:</strong> The <code>--no-cache-dir</code> option reduces the image size by not storing the pip cache.</p>
                        </div>
                        
                        <div class="collapsible">
                            <div class="collapsible-header" onclick="toggleCollapsible(this)">
                                Dependency Management Options
                            </div>
                            <div class="collapsible-content">
                                <h4>Pip</h4>
                                <p>The standard approach using a requirements.txt file:</p>
                                <div class="code-block">
                                    <span class="code-keyword">COPY</span> <span class="code-string">requirements.txt .</span><br>
                                    <span class="code-keyword">RUN</span> <span class="code-string">pip install --no-cache-dir -r requirements.txt</span>
                                </div>
                                
                                <h4>Poetry</h4>
                                <p>For projects using Poetry for dependency management:</p>
                                <div class="code-block">
                                    <span class="code-keyword">RUN</span> <span class="code-string">pip install --no-cache-dir poetry</span><br>
                                    <span class="code-keyword">COPY</span> <span class="code-string">pyproject.toml poetry.lock .</span><br>
                                    <span class="code-keyword">RUN</span> <span class="code-string">poetry install --no-dev</span>
                                </div>
                                
                                <h4>Pipenv</h4>
                                <p>For projects using Pipenv:</p>
                                <div class="code-block">
                                    <span class="code-keyword">RUN</span> <span class="code-string">pip install --no-cache-dir pipenv</span><br>
                                    <span class="code-keyword">COPY</span> <span class="code-string">Pipfile Pipfile.lock .</span><br>
                                    <span class="code-keyword">RUN</span> <span class="code-string">pipenv install --system</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="application-code">
                <h2>4. Application Code Copy</h2>
                <p>This step copies your application code into the container.</p>
                
                <div class="code-explanation">
                    <div class="code-block">
                        <span class="code-comment"># Copy your entire application code to the container</span><br>
                        <span class="code-comment"># The '.' means "copy everything from current directory"</span><br>
                        <br>
                        <span class="code-keyword">COPY</span> <span class="code-string">. /app</span><br>
                        <span class="code-comment"># ↑ CUSTOMIZE: Modify source and destination as needed:</span><br>
                        <span class="code-comment">#              - COPY ./src /app (if code is in 'src' folder)</span><br>
                        <span class="code-comment">#              - COPY ./myproject /app (if code is in specific folder)</span><br>
                        <span class="code-comment">#              - COPY *.py /app (if you only want Python files)</span>
                    </div>
                    
                    <div>
                        <h3>Explanation</h3>
                        <p>The <code>COPY</code> instruction copies files and directories from the build context to the container's filesystem.</p>
                        
                        <div class="status-box warning">
                            <p><strong>Important:</strong> Be mindful of what you copy. Use a <code>.dockerignore</code> file to exclude unnecessary files (like virtual environments, logs, etc.) to reduce image size and improve security.</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="environment">
                <h2>5. Environment Variables</h2>
                <p>Environment variables configure your application's behavior and are essential for containerized applications.</p>
                
                <div class="code-explanation">
                    <div class="code-block">
                        <span class="code-comment"># Set environment variables for your application</span><br>
                        <span class="code-comment"># PYTHONPATH tells Python where to find your modules</span><br>
                        <br>
                        <span class="code-keyword">ENV</span> <span class="code-string">PYTHONPATH=/app</span><br>
                        <span class="code-comment"># ↑ CUSTOMIZE: Add any environment variables your app needs</span>
                    </div>
                    
                    <div>
                        <h3>Explanation</h3>
                        <p>The <code>ENV</code> instruction sets environment variables that will be available to your application at runtime.</p>
                        
                        <div class="status-box info">
                            <p><strong>Common Environment Variables:</strong></p>
                            <ul>
                                <li><code>PYTHONPATH</code>: Specifies additional directories to look for Python modules</li>
                                <li><code>PYTHONUNBUFFERED</code>: Set to 1 to see Python output in real-time in logs</li>
                                <li>Database connection strings</li>
                                <li>API keys and other configuration values</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="exposing-ports">
                <h2>6. Exposing Ports</h2>
                <p>The EXPOSE instruction informs Docker that the container listens on the specified network ports at runtime.</p>
                
                <div class="code-explanation">
                    <div class="code-block">
                        <span class="code-comment"># Document which ports your application uses</span><br>
                        <span class="code-comment"># This doesn't actually publish the port, it serves as documentation</span><br>
                        <br>
                        <span class="code-keyword">EXPOSE</span> <span class="code-number">8000</span><br>
                        <span class="code-comment"># ↑ CUSTOMIZE: Replace with the port your application uses</span>
                    </div>
                    
                    <div>
                        <h3>Explanation</h3>
                        <p>The <code>EXPOSE</code> instruction documents which ports your application uses. The actual port mapping happens when you run the container with the <code>-p</code> flag.</p>
                        
                        <div class="status-box info">
                            <p><strong>Note:</strong> EXPOSE doesn't actually publish the port. It functions as documentation between the person who builds the image and the person who runs the container.</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="entrypoint">
                <h2>7. Entrypoint Configuration</h2>
                <p>The ENTRYPOINT instruction configures the container to run as an executable.</p>
                
                <div class="code-explanation">
                    <div class="code-block">
                        <span class="code-comment"># Define the command to run your application</span><br>
                        <span class="code-comment"># Use ENTRYPOINT for the main executable</span><br>
                        <br>
                        <span class="code-keyword">ENTRYPOINT</span> <span class="code-string">["python", "main.py"]</span><br>
                        <span class="code-comment"># ↑ CUSTOMIZE: Replace with your application's entry point</span><br>
                        <span class="code-comment">#              Options: ["python", "app.py"], ["python", "-m", "mymodule"]</span>
                    </div>
                    
                    <div>
                        <h3>Explanation</h3>
                        <p>The <code>ENTRYPOINT</code> instruction allows you to configure a container that will run as an executable. This is typically the command that starts your application.</p>
                        
                        <div class="status-box warning">
                            <p><strong>ENTRYPOINT vs CMD:</strong></p>
                            <ul>
                                <li>Use <code>ENTRYPOINT</code> for the main executable of your container</li>
                                <li>Use <code>CMD</code> to provide default arguments to the ENTRYPOINT</li>
                                <li>If both are defined, CMD arguments are passed to ENTRYPOINT</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="interactive-demo">
                <h2>Interactive Demo: Build Your Dockerfile</h2>
                <p>Use this interactive demo to customize and build your Dockerfile based on the options you've learned.</p>
                
                <div class="interactive-demo">
                    <h3>Configure Your Dockerfile</h3>
                    
                    <div class="input-box">
                        <label for="pythonVersion">Python Version:</label>
                        <select id="pythonVersion">
                            <option value="3.12-slim">3.12-slim</option>
                            <option value="3.12">3.12</option>
                            <option value="3.11-slim">3.11-slim</option>
                            <option value="3.10-slim">3.10-slim</option>
                        </select>
                    </div>
                    
                    <div class="input-box">
                        <label for="workdir">Working Directory:</label>
                        <input type="text" id="workdir" value="/app">
                    </div>
                    
                    <div class="input-box">
                        <label for="dependencyFile">Dependency File:</label>
                        <select id="dependencyFile">
                            <option value="requirements.txt">requirements.txt</option>
                            <option value="pyproject.toml">pyproject.toml (Poetry)</option>
                            <option value="Pipfile">Pipfile (Pipenv)</option>
                        </select>
                    </div>
                    
                    <div class="input-box">
                        <label for="appPort">Application Port:</label>
                        <input type="number" id="appPort" value="8000">
                    </div>
                    
                    <div class="input-box">
                        <label for="entryCommand">Entrypoint Command:</label>
                        <input type="text" id="entryCommand" value='["python", "main.py"]'>
                    </div>
                    
                    <button class="button" onclick="generateDockerfile()">Generate Dockerfile</button>
                    
                    <div class="output-box">
                        <h3>Your Dockerfile</h3>
                        <div class="code-block" id="generatedDockerfile">
                            <span class="code-comment"># Select options and click Generate to create your Dockerfile</span>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Toggle collapsible sections
        function toggleCollapsible(element) {
            element.classList.toggle("active");
            const content = element.nextElementSibling;
            content.classList.toggle("active");
        }
        
        // Update base image based on selection
        function updateBaseImage() {
            const select = document.getElementById('baseImageSelect');
            const output = document.getElementById('baseImageOutput');
            output.textContent = `Current selection: ${select.value}`;
        }
        
        // Generate Dockerfile based on user inputs
        function generateDockerfile() {
            const pythonVersion = document.getElementById('pythonVersion').value;
            const workdir = document.getElementById('workdir').value;
            const dependencyFile = document.getElementById('dependencyFile').value;
            const appPort = document.getElementById('appPort').value;
            const entryCommand = document.getElementById('entryCommand').value;
            
            let installCommand = 'pip install --no-cache-dir -r requirements.txt';
            let copyCommand = 'COPY requirements.txt .';
            
            if (dependencyFile === 'pyproject.toml') {
                installCommand = 'pip install poetry && poetry install --no-dev';
                copyCommand = 'COPY pyproject.toml poetry.lock .';
            } else if (dependencyFile === 'Pipfile') {
                installCommand = 'pip install pipenv && pipenv install --system';
                copyCommand = 'COPY Pipfile Pipfile.lock .';
            }
            
            const dockerfileContent = `
# Multi-Agent System Dockerfile
# Generated from interactive tutorial

FROM python:${pythonVersion}

WORKDIR ${workdir}

${copyCommand}
RUN ${installCommand}

COPY . .

ENV PYTHONPATH=${workdir}

EXPOSE ${appPort}

ENTRYPOINT ${entryCommand}
            `.trim();
            
            document.getElementById('generatedDockerfile').textContent = dockerfileContent;
        }
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Add smooth scrolling for navigation
            document.querySelectorAll('nav.toc a').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    const targetElement = document.querySelector(targetId);
                    window.scrollTo({
                        top: targetElement.offsetTop - 20,
                        behavior: 'smooth'
                    });
                });
            });
        });
    </script>
</body>
</html>
